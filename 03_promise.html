<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>3. Promise</title>
    <style>
      body {
        font-family: sans-serif;
        padding: 20px;
      }
      .container {
        max-width: 600px;
        margin: auto;
        padding: 20px;
        border: 1px solid lightgray;
        border-radius: 8px;
      }
      button {
        padding: 10px 15px;
        font-size: 16px;
        cursor: pointer;
        margin: 5px;
      }
      #log {
        margin-top: 20px;
        padding: 10px;
        border: 1px solid black;
        background-color: ghostwhite;
        min-height: 150px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>3. Promiseë¡œ ì½œë°± ì§€ì˜¥ íƒˆì¶œí•˜ê¸°</h1>
      <p>
        Promiseì˜ .then() ì²´ì´ë‹ì„ í†µí•´ ì½”ë“œê°€ ì–´ë–»ê²Œ ê°œì„ ë˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.
      </p>
      <button id="success-btn">ì„±ê³µ ì‹œë‚˜ë¦¬ì˜¤</button>
      <button id="fail-btn">ì‹¤íŒ¨ ì‹œë‚˜ë¦¬ì˜¤</button>
      <div id="log"></div>
    </div>

    <script>
      const successBtn = document.getElementById("success-btn");
      const failBtn = document.getElementById("fail-btn");
      const logDiv = document.getElementById("log");

      const log = (message, isError = false) => {
        logDiv.innerHTML += `<div style="color: ${
          isError ? "red" : "black"
        };">${message}</div>`;
      };

      /*
        ==================================================================================
        ğŸ¯ Promiseë€?
        ==================================================================================
        - ë¹„ë™ê¸° ì‘ì—…ì˜ ìµœì¢… ì„±ê³µ ë˜ëŠ” ì‹¤íŒ¨ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê°ì²´ì…ë‹ˆë‹¤.
        - ì„±ê³µì€ resolve, ì‹¤íŒ¨ëŠ” reject í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ ê²°ê³¼ë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤.
        - .then(onFulfilled, onRejected): ì‘ì—… ì„±ê³µ/ì‹¤íŒ¨ ì‹œ ì‹¤í–‰ë  í•¨ìˆ˜ë¥¼ ë“±ë¡í•©ë‹ˆë‹¤.
        - .catch(onRejected): ì‘ì—… ì‹¤íŒ¨ ì‹œ ì‹¤í–‰ë  í•¨ìˆ˜ë¥¼ ë“±ë¡í•©ë‹ˆë‹¤. .then(null, onRejected)ê³¼ ê°™ìŠµë‹ˆë‹¤.
        - .finally(onFinally): ì„±ê³µ/ì‹¤íŒ¨ ì—¬ë¶€ì™€ ìƒê´€ì—†ì´ ë§ˆì§€ë§‰ì— í•­ìƒ ì‹¤í–‰ë©ë‹ˆë‹¤.
        */

      // Promiseë¥¼ ë°˜í™˜í•˜ëŠ” ë¹„ë™ê¸° ì‘ì—… í•¨ìˆ˜
      function asyncTask(taskName, duration, shouldSucceed) {
        log(`â³ '${taskName}' ì‘ì—… ì‹œì‘...`);
        // Promise ê°ì²´ë¥¼ ìƒì„±í•˜ì—¬ ì¦‰ì‹œ ë°˜í™˜í•©ë‹ˆë‹¤.
        return new Promise((resolve, reject) => {
          setTimeout(() => {
            if (shouldSucceed) {
              log(`âœ… '${taskName}' ì‘ì—… ì„±ê³µ!`);
              resolve(`${taskName}ì˜ ê²°ê³¼ë¬¼`); // ì„±ê³µ ì‹œ resolve í˜¸ì¶œ
            } else {
              log(`âŒ '${taskName}' ì‘ì—… ì‹¤íŒ¨!`);
              reject(new Error(`'${taskName}'ì—ì„œ ì—ëŸ¬ ë°œìƒ`)); // ì‹¤íŒ¨ ì‹œ reject í˜¸ì¶œ
            }
          }, duration);
        });
      }

      // ì„±ê³µ ì‹œë‚˜ë¦¬ì˜¤ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
      successBtn.addEventListener("click", () => {
        logDiv.innerHTML = "";

        // ğŸ§‘â€ğŸ’» ì—¬ê¸°ì— ì½”ë“œë¥¼ ì‘ì„±í•˜ì„¸ìš”.
        // 1. asyncTask('ì‚¬ìš©ì ì •ë³´ ê°€ì ¸ì˜¤ê¸°', 1000, true)ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.
        // 2. .then()ì„ ì‚¬ìš©í•˜ì—¬ ì²« ë²ˆì§¸ ì‘ì—…ì´ ì„±ê³µí•˜ë©´ asyncTask('ê²Œì‹œë¬¼ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°', 1000, true)ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.
        // 3. .then()ì„ ì‚¬ìš©í•˜ì—¬ ë‘ ë²ˆì§¸ ì‘ì—…ì´ ì„±ê³µí•˜ë©´ asyncTask('ëŒ“ê¸€ ì •ë³´ ê°€ì ¸ì˜¤ê¸°', 1000, true)ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.
        // 4. ë§ˆì§€ë§‰ .then()ì—ì„œ ëª¨ë“  ì‘ì—…ì´ ì™„ë£Œë˜ì—ˆìŒì„ ì•Œë¦¬ëŠ” ë¡œê·¸ë¥¼ ì¶œë ¥í•©ë‹ˆë‹¤.
        // 5. .catch()ë¥¼ ì‚¬ìš©í•˜ì—¬ í˜¹ì‹œ ëª¨ë¥¼ ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤.
      });

      // ì‹¤íŒ¨ ì‹œë‚˜ë¦¬ì˜¤ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
      failBtn.addEventListener("click", () => {
        logDiv.innerHTML = "";

        // ğŸ§‘â€ğŸ’» ì—¬ê¸°ì— ì½”ë“œë¥¼ ì‘ì„±í•˜ì„¸ìš”.
        // 1. asyncTaskë¥¼ ìˆœì„œëŒ€ë¡œ í˜¸ì¶œí•˜ë˜, ë‘ ë²ˆì§¸ ì‘ì—…ì¸ 'ê²Œì‹œë¬¼ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°'ê°€ ì‹¤íŒ¨í•˜ë„ë¡
        //    shouldSucceed ì¸ìë¥¼ falseë¡œ ì„¤ì •í•˜ì—¬ í˜¸ì¶œí•©ë‹ˆë‹¤.
        // 2. ì„¸ ë²ˆì§¸ ì‘ì—…ì€ ì‹¤í–‰ë˜ì§€ ì•Šì•„ì•¼ í•©ë‹ˆë‹¤.
        // 3. .catch()ë¥¼ ì‚¬ìš©í•˜ì—¬ "ìµœì¢… ì—ëŸ¬ ì²˜ë¦¬: [ì—ëŸ¬ë©”ì‹œì§€]" í˜•ì‹ìœ¼ë¡œ ë¡œê·¸ë¥¼ ì¶œë ¥í•©ë‹ˆë‹¤.
      });
    </script>
  </body>
</html>
